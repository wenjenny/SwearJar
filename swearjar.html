<!DOCTYPE html>
<html>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"> </script>
<style>
    td { padding: 15px; }
</style>
<body>

<table>
    <tr>
        <td>
            eleanor
        </td>
        <td>
            celine
        </td>
    </tr>
    <tr>
        <td>
            patty <br>
            <button onclick="pAdd()">+</button>
            <p id="pCount"></p>
            <button onclick="pSub()">-</button>
        </td>
        <td>
            karina
        </td>
    </tr>
    </table>

    <canvas id="myChart" style="width:100%;max-width:700px"></canvas>

<script>

var pCount = 0;
var eCount = 0;
var cCount = 0;
var kCount = 0;
var lst;

const scriptURL = 'https://script.google.com/macros/s/AKfycbz2V6_iO8D9pZlzdJ9g4hLVIjuKiw359pScDK4Mv0u4N8d2xXV0bCICh6ZKe8qxHdOk/exec'

async function getInfo() {
    let response = await fetch(scriptURL, {method: 'GET'})
    let responseText = await response.text()
        
    /*
    parsing
    0: patty total
    1: enor total
    2: celine total
    3: karina total
    4: patty exercise
    5: enor exercise
    6: celine exercise
    7: karina exercise
    */
   var lst = responseText.split(',')
   pCount = parseInt(lst[0])
   eCount = lst[1]
   cCount = lst[2]
   kCount = lst[3]
   document.getElementById('pCount').innerHTML=pCount
}

window.onload = getInfo;

var xValues = ["Patty", "Eleanor", "Celine", "Karina"];
var yValues = [pCount, eCount, cCount, kCount];
var barColors = ["#241528", "d134e9",'#3f1a44',"#4a6b8c"];

const chart = new Chart("myChart", {
  type: "bar",
  data: {
    labels: xValues,
    datasets: [{
      backgroundColor: barColors,
      data: yValues
    }]
  },
  options: {
    legend: {display: false},
    title: {
      display: true,
      text: "Swear Jar Totals"
    },
    scales: {
        yAxes: [{
            ticks: {
                beginAtZero: true,
                callback: function(value) {if (value % 1 === 0) {return value;}}
            }
        }]
    }
  }
});

function pAdd() {
    pCount += 1;
    document.getElementById("pCount").innerHTML = pCount;
    chart.data.datasets[0].data[0] += 1;
    chart.update();
}
function pSub() {
    pCount -= 1;
    document.getElementById("pCount").innerHTML = pCount;
    chart.data.datasets[0].data[0] -= 1;
    chart.update();
}

</script>

</body>
</html>

